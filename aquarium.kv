#:kivy 2.0

#:include settings.kv
#:include graph.kv
#:include settings_sensors.kv
#:import isdir os.path.isdir
#:set clown_fish 'images/clown-fish.png'
#:set semisfere 'images/scala.png'
#:set arrow 'images/lancetta.png'
#:set xcenter 25
#:set ycenter 9
#:set arrowx 76
#:set arrowy 45

MainWidget: 

<MainWidget>:

    #top
    Image:
        size_hint: None, None
        size:30,30
        pos: 550,565
        source: clown_fish
    Image:
        size_hint: None, None
        size:30,30
        pos: 442,565
        source: clown_fish
    Label:
        text: "Aquarium"
        bold: True
        pos: 0, 280
    Label:
        id: username
        text: "N/A"
        bold: True
        pos: -400, 280
    Label:
        id: time
        text: '00:00:00'
        font_name: 'fonts/dd.otf'
        font_size: 20
        pos: 450,280

    Image:
        id: graph_temp_int_sfere
        source: semisfere
        size_hint: None, None
        size: 200, 200
        #pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        pos: 20,380

    Image:
        id: graph_temp_int_arrow
        name: 'arrow'
        angle: 120

        source: arrow
        size_hint: None, None
        size: 90,90
        pos: 20+arrowx,380+arrowy
        #pos_hint: {'center_x': 0.5, 'center_y': 0.5}   
        # apply rotation matrix to this Image                                                                                                                                            
        canvas.before:                                                                                                                                             
            PushMatrix                                                                                                                                             
            Rotate:                                                                                                                                                
                angle: self.angle                                                                                                                                  
                axis: (0, 0, 1)
                origin: 20+arrowx+xcenter,380+arrowy+ycenter                                                                                                                                    
                #origin: (self.center_x - self.norm_image_size[0]/2, self.center_y - self.norm_image_size[1]/2, 0)                                                                                                                              
        canvas.after:                                                                                                                                              
            PopMatrix  

    Label:
        text: 'Aquarium Temperature:'
        bold: True
        pos: 20, 400
        text_size:self.size
        #halign: "left"
        #valign: "middle"
    Label:
        id: temp_int
        text: 'N/A°C'
        bold: True
        pos: 180, 400
        text_size:self.size
        #halign: "left"
        #valign: "middle"
    Label:
        id: date_int
        text: 'N/A'
        bold: True
        pos: 100, 380
        text_size:self.size
    
    Image:
        id: graph_temp_int_sfere
        source: semisfere
        size_hint: None, None
        size: 200, 200
        #pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        pos: 300,380

    Image:
        id: graph_temp_ext_arrow
        name: 'arrow'
        angle: 120

        source: arrow
        size_hint: None, None
        size: 90,90
        pos: 300+arrowx,380+arrowy
        #pos_hint: {'center_x': 0.5, 'center_y': 0.5}   
        # apply rotation matrix to this Image                                                                                                                                            
        canvas.before:                                                                                                                                             
            PushMatrix                                                                                                                                             
            Rotate:                                                                                                                                                
                angle: self.angle                                                                                                                                  
                axis: (0, 0, 1)
                origin: 300+arrowx+xcenter,380+arrowy+ycenter                                                                                                                                    
                #origin: (self.center_x - self.norm_image_size[0]/2, self.center_y - self.norm_image_size[1]/2, 0)                                                                                                                              
        canvas.after:                                                                                                                                              
            PopMatrix 

    Label:
        text: 'External Temperature:'
        bold: True
        pos: 305, 400
        text_size:self.size
        #halign: "left"
        #valign: "middle"
    
    Label:
        id: temp_ext
        text: 'N/A°C'
        bold: True
        pos: 460, 400
        text_size:self.size
        #halign: "left"
        #valign: "middle"
    
    Label:
        id: date_ext
        text: 'N/A'
        bold: True
        text_size:self.size
        pos: 380, 380

    Image:
        id: graph_temp_int_sfere
        source: semisfere
        size_hint: None, None
        size: 200, 200
        #pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        pos: 150,200

    Image:
        id: graph_temp_hum_arrow
        name: 'arrow'
        angle: 120

        source: arrow
        size_hint: None, None
        size: 90,90
        pos: 150+arrowx,200+arrowy
        #pos_hint: {'center_x': 0.5, 'center_y': 0.5}   
        # apply rotation matrix to this Image                                                                                                                                            
        canvas.before:                                                                                                                                             
            PushMatrix                                                                                                                                             
            Rotate:                                                                                                                                                
                angle: self.angle                                                                                                                                  
                axis: (0, 0, 1)
                origin: 150+arrowx+xcenter,200+arrowy+ycenter                                                                                                                                    
                #origin: (self.center_x - self.norm_image_size[0]/2, self.center_y - self.norm_image_size[1]/2, 0)                                                                                                                              
        canvas.after:                                                                                                                                              
            PopMatrix 

    Label:
        text: 'External Humidity:'
        bold: True
        pos: 160, 220
        text_size:self.size
        #halign: "left"
        #valign: "middle"
    
    Label:
        id: hum_ext
        text: 'N/A%'
        bold: True
        pos: 290, 220
        text_size:self.size
        #halign: "left"
        #valign: "middle"
    Label:
        id: date_ext_b
        text: 'N/A'
        bold: True
        text_size:self.size
        pos: 230, 200

    Button:
        text: 'Settings'
        on_press:
            root.manager.transition.direction = 'left'
            root.manager.current = 'settings'
        size_hint: None, None
        size: 100, 50
        pos: 804, 10
        
    Button:    
        text: 'Graph'
        on_press:
            root.manager.transition.direction = 'left'
            root.manager.current = 'graphs'
        size_hint: None, None
        size: 100, 50
        pos: 914, 10
        
